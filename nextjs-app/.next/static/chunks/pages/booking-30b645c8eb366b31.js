(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{2385:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/booking",function(){return t(128)}])},7508:function(e,a,t){"use strict";var n=t(5893),r=t(5379),s=t.n(r),i=t(1664),l=t.n(i),o=t(7294),d=t(4750),c=t(1163);a.Z=()=>{let[e,a]=(0,o.useState)(null),[t,r]=(0,o.useState)(!1),i=(0,c.useRouter)();(0,o.useEffect)(()=>{let getSession=async()=>{var e;let{data:{session:t}}=await (0,d.N)().auth.getSession();a(null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null)};getSession();let{data:{subscription:e}}=(0,d.N)().auth.onAuthStateChange((e,t)=>{var n;a(null!==(n=null==t?void 0:t.user)&&void 0!==n?n:null)});return()=>e.unsubscribe()},[]);let handleLogout=async()=>{await (0,d.N)().auth.signOut(),i.push("/")};return(0,n.jsxs)("header",{className:"jsx-411ff4dbbd43a9a7 navbar",children:[(0,n.jsxs)("div",{className:"jsx-411ff4dbbd43a9a7 container",children:[(0,n.jsx)(l(),{href:"/",className:"logo",children:"GO-RENT"}),(0,n.jsxs)("nav",{className:"jsx-411ff4dbbd43a9a7 nav-links",children:[(0,n.jsx)(l(),{href:"/browse",children:"Browse Cars"}),e&&(0,n.jsx)(l(),{href:"/bookings",children:"My Bookings"}),(null==e?void 0:e.email)==="admin@gorent.com"&&(0,n.jsx)(l(),{href:"/admin",children:"Admin"})]}),(0,n.jsx)("div",{className:"jsx-411ff4dbbd43a9a7 auth-buttons",children:e?(0,n.jsxs)("div",{className:"jsx-411ff4dbbd43a9a7 user-menu",children:[(0,n.jsx)("button",{onClick:()=>r(!t),className:"jsx-411ff4dbbd43a9a7 btn btn-outline user-btn",children:e.email}),t&&(0,n.jsx)("div",{className:"jsx-411ff4dbbd43a9a7 dropdown",children:(0,n.jsx)("button",{onClick:handleLogout,className:"jsx-411ff4dbbd43a9a7 logout-btn",children:"Logout"})})]}):(0,n.jsx)(l(),{href:"/login",className:"btn btn-outline",children:"Login / Sign in"})})]}),(0,n.jsx)(s(),{id:"411ff4dbbd43a9a7",children:".user-menu.jsx-411ff4dbbd43a9a7{position:relative}.user-btn.jsx-411ff4dbbd43a9a7{cursor:pointer}.dropdown.jsx-411ff4dbbd43a9a7{position:absolute;top:100%;right:0;background:white;border:1px solid#e5e7eb;-webkit-border-radius:.375rem;-moz-border-radius:.375rem;border-radius:.375rem;-webkit-box-shadow:0 10px 15px -3px rgba(0,0,0,.1);-moz-box-shadow:0 10px 15px -3px rgba(0,0,0,.1);box-shadow:0 10px 15px -3px rgba(0,0,0,.1);z-index:10;min-width:120px}.logout-btn.jsx-411ff4dbbd43a9a7{width:100%;padding:.5rem 1rem;background:none;border:none;text-align:left;cursor:pointer;color:#374151}.logout-btn.jsx-411ff4dbbd43a9a7:hover{background:#f9fafb}"})]})}},4124:function(e,a,t){"use strict";t.d(a,{F:function(){return getCarById},R:function(){return getCars}});var n=t(4750);let getCars=async()=>{let{data:e,error:a}=await (0,n.N)().from("cars").select("*").order("id");return a?(console.error("Error fetching cars:",a),[]):e||[]},getCarById=async e=>{let{data:a,error:t}=await (0,n.N)().from("cars").select("*").eq("id",e).single();return t?(console.error("Error fetching car:",t),null):a}},128:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return Booking}});var n=t(5893),r=t(9008),s=t.n(r),i=t(1664),l=t.n(i),o=t(1163),d=t(7294),c=t(4124),u=t(4750),h=t(7508);function Booking(){let e=(0,o.useRouter)(),{id:a}=e.query,[t,r]=(0,d.useState)(null),[i,b]=(0,d.useState)(""),[m,x]=(0,d.useState)("");(0,d.useEffect)(()=>{let fetchCar=async()=>{if(a){let e=await (0,c.F)(parseInt(a));r(e)}};fetchCar()},[a]);let calculateTotal=()=>{if(!i||!m||!t)return null;let e=new Date(i),a=new Date(m),n=Math.abs(a.getTime()-e.getTime()),r=Math.ceil(n/864e5),s=parseFloat(t.price.replace("$","").replace("/day","")),l=(s*r).toFixed(2);return{days:r,total:"$".concat(l)}},handleSubmit=async a=>{if(a.preventDefault(),!i||!m||!t){alert("Please select both start and end dates.");return}let n=calculateTotal();if(!n)return;let{data:{user:r}}=await (0,u.N)().auth.getUser();if(!r){alert("Please log in to make a booking."),e.push("/login");return}let s={user_id:r.id,car_id:t.id,car_name:"".concat(t.brand," ").concat(t.model),check_in:i,check_out:m,duration:"".concat(n.days," Days"),price:t.price,total:n.total,status:"Pending"},{error:l}=await (0,u.N)().from("bookings").insert([s]);if(l){console.error("Error creating booking:",l),alert("Failed to create booking. Please try again.");return}alert("Booking confirmed! Confirmation email will be sent."),e.push("/bookings")};if(!t)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s(),{children:(0,n.jsx)("title",{children:"Book Car - GO-RENT"})}),(0,n.jsx)(h.Z,{}),(0,n.jsx)("main",{children:(0,n.jsx)("div",{className:"container",style:{padding:"2rem 0"},children:(0,n.jsx)("p",{children:"Car not found."})})})]});let f=calculateTotal();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s(),{children:(0,n.jsxs)("title",{children:["Book ",t.brand," ",t.model," - GO-RENT"]})}),(0,n.jsx)(h.Z,{}),(0,n.jsx)("main",{children:(0,n.jsxs)("div",{className:"container",style:{padding:"2rem 0"},children:[(0,n.jsx)(l(),{href:"/browse",style:{color:"#2563eb",textDecoration:"none",marginBottom:"2rem",display:"inline-block"},children:"< Back To Cars"}),(0,n.jsxs)("div",{className:"booking-content",children:[(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"booking-image",children:(0,n.jsx)("img",{src:t.image,alt:"".concat(t.brand," ").concat(t.model),style:{width:"100%",height:"100%",objectFit:"cover"}})})}),(0,n.jsxs)("div",{className:"booking-form",children:[(0,n.jsx)("h2",{style:{fontSize:"1.5rem",fontWeight:"600",marginBottom:"2rem"},children:"Book This Car"}),(0,n.jsx)("div",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#16a6a3",marginBottom:"1rem",textAlign:"center"},children:t.price}),(0,n.jsxs)("form",{onSubmit:handleSubmit,children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Start Date"}),(0,n.jsx)("input",{type:"date",value:i,onChange:e=>b(e.target.value),required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"End Date"}),(0,n.jsx)("input",{type:"date",value:m,onChange:e=>x(e.target.value),required:!0})]}),f&&(0,n.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"8px",textAlign:"center",fontWeight:"600",fontSize:"1.1rem"},children:["Total: ",f.total," (",f.days," days)"]}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary btn-full",children:"Book Now"})]})]})]}),(0,n.jsxs)("div",{className:"booking-details",children:[(0,n.jsxs)("h3",{style:{fontSize:"1.5rem",fontWeight:"600",marginBottom:"1rem"},children:[t.brand," ",t.model]}),(0,n.jsx)("p",{style:{color:"#6b7280",marginBottom:"2rem"},children:t.description}),(0,n.jsxs)("div",{className:"detail-grid",children:[(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("div",{className:"label",children:"Year"}),(0,n.jsx)("div",{className:"value",children:t.year})]}),(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("div",{className:"label",children:"Seats"}),(0,n.jsx)("div",{className:"value",children:t.seats})]}),(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("div",{className:"label",children:"Transmission"}),(0,n.jsx)("div",{className:"value",children:t.gear})]}),(0,n.jsxs)("div",{className:"detail-item",children:[(0,n.jsx)("div",{className:"label",children:"Color"}),(0,n.jsx)("div",{className:"value",children:t.color})]})]})]})]})})]})}},4750:function(e,a,t){"use strict";t.d(a,{N:function(){return getSupabaseClient}});var n=t(2629);let r=null,getSupabaseClient=()=>{if(!r){let e="your_supabase_project_url_here",a="your_supabase_anon_key_here";e&&a&&(r=(0,n.eI)(e,a))}return r}}},function(e){e.O(0,[151,774,888,179],function(){return e(e.s=2385)}),_N_E=e.O()}]);